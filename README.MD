# Piper Fruit Picking Robot 

![ubuntu](https://img.shields.io/badge/Ubuntu-20.04-orange.svg) ![ros](https://img.shields.io/badge/ROS-noetic-blue.svg) ![status](https://img.shields.io/badge/Pass-blue.svg)

> æœ¬é¡¹ç›®é›†æˆ **YOLO ç›®æ ‡æ£€æµ‹**ã€**æœºæ¢°è‡‚ MoveIt æ§åˆ¶** ä¸ **3Dè§†è§‰å®šä½**ï¼Œå®ç°å¯¹æˆç†Ÿæœå®çš„è‡ªåŠ¨è¯†åˆ«ä¸æŠ“å–ã€‚

---

â­è¦è®²yoloæ£€æµ‹ç§»æ¤åˆ°rk3588æ¿ä¸Šéœ€å‚è€ƒ[https://github.com/airockchip/yolov5/blob/master/README_rkopt.md](https://github.com/airockchip/yolov5/blob/master/README_rkopt.md)

## ğŸ§­ Quick Start

### ğŸ”§ ç¼–è¯‘å·¥ä½œç©ºé—´

```bash
cd eyes_piper/piper_ros
catkin_make
```

### å®‰è£… udev è§„åˆ™

```
cd eyes_piper/piper_ros
source ./devel/setup.bash
roscd astra_camera
./scripts/create_udev_rules
sudo udevadm control --reload && sudo udevadm trigger
```

### å®‰è£… Python ä¾èµ–

```
pip install -r requirement.txt
```


---

### ğŸ–¥ï¸ å¯åŠ¨æµç¨‹ï¼ˆ5ä¸ªç»ˆç«¯ï¼‰

#### **ç»ˆç«¯1ï¼šå¯åŠ¨ç›¸æœºä¸YOLOæ£€æµ‹ç®—æ³•**

```bash
source devel/setup.bash
roslaunch astra_camera dabai.launch
```

> å‘å¸ƒæ£€æµ‹ç›®æ ‡åæ ‡è‡³è¯é¢˜ `/yolo/label_xyz`

---

#### **ç»ˆç«¯2ï¼šCANåˆå§‹åŒ–å¹¶ä½¿èƒ½æœºæ¢°è‡‚**

```bash
source devel/setup.bash
bash can_activate.sh can0 1000000
roslaunch piper start_single_piper.launch gripper_val_mutiple:=2
```

---

#### **ç»ˆç«¯3ï¼šå¯åŠ¨ MoveIt æ§åˆ¶æœåŠ¡ï¼ˆå¯é€‰å¯åŠ¨ RVizï¼‰**

```bash
source devel/setup.bash
roslaunch piper_with_gripper_moveit demo.launch use_rviz:=false
```

---

#### **ç»ˆç«¯4ï¼šå‘å¸ƒ camera\_link ä¸ gripper\_base ä¹‹é—´çš„é™æ€TF & åŠ è½½YOLO**

```bash
source devel/setup.bash
roslaunch astra_camera cam_function.launch
```

è®¾ç½®å‚æ•°å¼€å¯ç›®æ ‡æ£€æµ‹ä¸å›¾åƒæ˜¾ç¤ºï¼š

```bash
source devel/setup.bash
rosparam set /go_detect true
rosparam set /yolo/show_image true
```


---

#### **ç»ˆç«¯5ï¼šæ‰§è¡Œå®šä½ä¸æŠ“å–ä»»åŠ¡ï¼ˆå•æ£µæ ‘ï¼‰**

```bash
source devel/setup.bash
rosrun moveit_ctrl pick_one.py
```

---

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

* âœ… **æœå®æ£€æµ‹ä¸3Då®šä½**ï¼šYOLOæ¨¡å‹æ£€æµ‹æˆç†Ÿæœå®ï¼Œç»“åˆæ·±åº¦å›¾è¿˜åŸç©ºé—´åæ ‡ã€‚
* âœ… **ç›®æ ‡å§¿æ€è·Ÿéš**ï¼šæŠ“å–å‰è‡ªåŠ¨è°ƒæ•´ base å…³èŠ‚ï¼Œä½¿ gripper å§‹ç»ˆæ­£å¯¹ç›®æ ‡ã€‚
* âœ… **MoveItç²¾ç¡®æ§åˆ¶**ï¼šé€šè¿‡ `JointMoveitCtrl` æœåŠ¡å®Œæˆå¸¦å§¿æ€æœ«ç«¯æŠ“å–ã€‚
* âœ… **å¤¹çˆªæ§åˆ¶**ï¼šæŠ“å–å‰æ‰“å¼€ï¼Œæ¥è¿‘ç›®æ ‡åå¯è¿›ä¸€æ­¥é—­åˆã€‚

---

## ğŸ“¦ é¡¹ç›®ç»“æ„ç®€è¿° (piper_ros/src)

```bash
â”œâ”€â”€ ros_astra_camera/       # ç›¸æœºrosåŒ…
â”‚   â”œâ”€â”€ scripts/ 
â”‚   â”‚   â”œâ”€â”€ ros_detect.py/      # åœ¨ç›¸æœºä¸Šæ‰§è¡Œyoloæ£€æµ‹çš„rosserviceè„šæœ¬æ–‡ä»¶â­
â”œâ”€â”€ piper_moveit/ 
â”‚   â”œâ”€â”€ moveit_ctrl/     # MoveItæ§åˆ¶æœåŠ¡ä¸ä»»åŠ¡æ‰§è¡Œè„šæœ¬
â”‚       â”œâ”€â”€ scripts/        # pick_one.py æ‰€åœ¨ç›®å½•â­
â”‚   â”œâ”€â”€ piper_with_gripper_moveit/
â”‚   â”‚   â”œâ”€â”€ launch/
â”‚   â”‚   â”‚   â”œâ”€â”€ static_tf.launch     # camera_link ä¸ gripper_base çš„åæ ‡å˜æ¢â­
â”‚   â”‚   â”‚   â””â”€â”€ demo.launch          # æœºæ¢°è‡‚MoveIt æ§åˆ¶å™¨å¯åŠ¨æ–‡ä»¶
â”œâ”€â”€ can_activate.sh         # åˆå§‹åŒ–CANè®¾å¤‡è„šæœ¬
â””â”€â”€ README.md
```

---

## ğŸ”— å‚è€ƒèµ„æ–™

* **å¥¥æ¯”ä¸­å…‰ç›¸æœºé©±åŠ¨**
  [https://github.com/orbbec/ros\_astra\_camera](https://github.com/orbbec/ros_astra_camera)

* **æ¾çµ Piper æœºæ¢°è‡‚ API**
  [https://github.com/agilexrobotics/piper\_ros](https://github.com/agilexrobotics/)

* **æ‰‹çœ¼æ ‡å®š easy\_handeye**
  [https://github.com/IFL-CAMP/easy\_handeye](https://github.com/IFL-CAMP/easy_handeye)


